import { RandomBytesDep } from "../Crypto.js";
import { Mnemonic } from "../Type.js";
import { AppOwner, OwnerId } from "./Owner.js";
/**
 * Local authentication and authorization system for Evolu. This is API is
 * subject to change and not recommended for production use.
 *
 * @experimental
 */
export interface LocalAuth {
    /** Logs in with the given owner ID, or loads the target owner if not provided. */
    login: (ownerId: OwnerId, options?: LocalAuthOptions) => Promise<AuthResult | null>;
    /** Registers a new owner with the given username. */
    register: (username: string, options?: LocalAuthOptions & {
        mnemonic?: Mnemonic | null;
    }) => Promise<AuthResult | null>;
    /** Unregisters an owner with the given owner ID. */
    unregister: (ownerId: OwnerId, options?: LocalAuthOptions) => Promise<void>;
    /** Gets the current owner (last logged in or last registered owner) */
    getOwner: (options?: LocalAuthOptions) => Promise<AuthResult | null>;
    /** Lists all registered owner ids with associated usernames. */
    getProfiles: (options?: LocalAuthOptionsValues) => Promise<Array<AuthList>>;
    /** Clears all owners and metadata from the local auth. */
    clearAll: (options?: LocalAuthOptions) => Promise<void>;
}
export interface LocalAuthDep {
    readonly localAuth: LocalAuth;
}
/**
 * Secure storage interface that must be implemented by each platform.
 *
 * @experimental
 */
export interface SecureStorage {
    setItem: (key: string, value: string, options?: LocalAuthOptions) => Promise<MutationResult>;
    getItem: (key: string, options?: LocalAuthOptionsValues) => Promise<SensitiveInfoItem | null>;
    deleteItem: (key: string, options?: LocalAuthOptions) => Promise<boolean>;
    getAllItems: (options?: LocalAuthOptionsValues) => Promise<Array<SensitiveInfoItem>>;
    clearService: (options?: LocalAuthOptions) => Promise<void>;
}
export interface SecureStorageDep {
    readonly secureStorage: SecureStorage;
}
/**
 * Creates a local auth using the given secure storage implementation. This
 * factory function allows each platform to provide its own storage layer while
 * sharing the common auth logic.
 */
export declare const createLocalAuth: (deps: SecureStorageDep & RandomBytesDep) => LocalAuth;
export declare const localAuth_Namespace = "evolu";
export declare const localAuthDefaultOptions: LocalAuthOptions;
export interface AuthResult {
    /** The app owner created during registration. */
    readonly owner: AppOwner | undefined;
    /** The name provided by the user during registration. */
    readonly username: string;
}
export interface AuthList {
    /** The app owner ID. */
    readonly ownerId: OwnerId;
    /** The name provided by the user during registration. */
    readonly username: string;
}
export interface LocalAuthOptions {
    /**
     * Native: Namespaces the stored entry. Defaults to the bundle identifier
     * (when available) or `default`.
     */
    readonly service?: string;
    /** IOS: Enable keychain item synchronization via iCloud. */
    readonly iosSynchronizable?: boolean;
    /** IOS: Custom keychain access group. */
    readonly keychainGroup?: string;
    /**
     * Native: Desired access-control policy. The native implementation will
     * automatically fall back to the strongest supported policy for the current
     * device (Secure Enclave ➝ Biometry ➝ Device Credential ➝ None).
     */
    readonly accessControl?: AccessControl;
    /**
     * Android: Fine tune whether the hardware-authenticated key should require
     * biometrics only.
     */
    readonly androidBiometricsStrongOnly?: boolean;
    /**
     * Native: Optional prompt configuration that will be shown when protected
     * keys require user presence.
     */
    readonly authenticationPrompt?: AuthenticationPrompt;
    /** Web: The relying party ID for WebAuthn. Defaults to the current hostname. */
    readonly relyingPartyID?: string;
    /** Web: The relying party name for WebAuthn. Defaults to 'Evolu'. */
    readonly relyingPartyName?: string;
    /** Web: The username for WebAuthn. Defaults to 'Evolu User'. */
    readonly webAuthnUsername?: string;
    /**
     * Web: The user verification requirement for WebAuthn. Defaults to
     * 'required'.
     */
    readonly webAuthnUserVerification?: UserVerificationRequirement;
    /** Web: The authenticator attachment for WebAuthn. Defaults to 'platform'. */
    readonly webAuthnAuthenticatorAttachment?: AuthenticatorAttachment;
}
export interface LocalAuthOptionsValues extends LocalAuthOptions {
    /** When true, the stored value is returned for each item. Defaults to false. */
    readonly includeValues?: boolean;
}
/**
 * Configuration for the biometric/device credential prompt shown when a
 * protected item is accessed.
 */
export interface AuthenticationPrompt {
    readonly title: string;
    readonly subtitle?: string;
    readonly description?: string;
    readonly cancel?: string;
}
export interface SensitiveInfoGetRequest extends LocalAuthOptions {
    readonly key: string;
    /** Include the encrypted value when available. Defaults to true. */
    readonly includeValue?: boolean;
}
export interface StorageMetadata {
    readonly securityLevel: SecurityLevel;
    readonly backend: StorageBackend;
    readonly accessControl: AccessControl;
    readonly timestamp: number;
}
export interface SensitiveInfoItem {
    readonly key: string;
    readonly service: string;
    readonly value?: string;
    readonly metadata: StorageMetadata;
}
export interface MutationResult {
    readonly metadata: StorageMetadata;
}
/**
 * Enumerates the highest security tier that was effectively applied while
 * storing a value.
 */
export type SecurityLevel = "secureEnclave" | "strongBox" | "biometry" | "deviceCredential" | "software";
/** Enumerates the native storage backend used to persist sensitive data. */
export type StorageBackend = "keychain" | "androidKeystore" | "encryptedSharedPreferences";
/**
 * Enumerates the access-control policy enforced by the underlying secure
 * storage.
 */
export type AccessControl = "secureEnclaveBiometry" | "biometryCurrentSet" | "biometryAny" | "devicePasscode" | "none";
//# sourceMappingURL=LocalAuth.d.ts.map